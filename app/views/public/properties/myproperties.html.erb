<div class="container">
  <div class="d-grid gap-2 col-5 mx-auto text-center">
  <h2>取り扱い物件一覧</h2>
  </div>
<br>
<br>
<div class="d-grid gap-2 col-4 mx-auto text-center">
<button type="button" class="btn btn-info btn-lg btn-block" data-toggle="collapse" data-target="#search">物件を検索する</button>
</div>
<div id="search" class="collapse">

<br>
<%= search_form_for @q, url: properties_myproperties_path do |f| %>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :id, "物件ID" %>
    </div>
    <div class="col-sm-4">
      <%= f.search_field :id_eq , class: "form-control", style: "width:60%" %>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :prefecture, "都道府県" %>
    </div>
    <div class="col-sm-4">
      <%= f.collection_select(:prefecture, Property.all, :id, :prefecture , include_blank: '選択') %>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :municipality, "市区町村" %>
    </div>
    <div class="col-sm-4">
      <%= f.search_field :municipality_cont, class: "form-control", style: "width:60%" %>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :kind, "物件種別" %>
    </div>
    <div class="col-sm-4">
      <%= f.collection_select(:kind, Property.all, :id, :kind, include_blank: '選択')  %>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :right, "権利種別" %>
    </div>
    <div class="col-sm-4">
      <%= f.collection_select(:right, Property.all, :id, :right, include_blank: '選択')  %>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :line, "路線" %>
    </div>
    <div class="col-sm-4">
      <%= f.search_field :line_cont, class: "form-control" , style: "width:60%" %>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :station, "駅名" %>
    </div>
    <div class="col-sm-4">
      <%= f.search_field :station_cont, class: "form-control", style: "width:60%" %>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :walking_minute, "徒歩" %>
    </div>
    <div class="col-sm-2">
      <%= f.number_field :walking_minute_gteq, class: "form-control", style: "width:60%" ,min:1%>
      <p class="align-middle">分〜</p>
    </div>
    <div class="col-sm-2">
      <%= f.number_field :walking_minute_lt, class: "form-control", style: "width:60%" ,min:1 %>
      <p class="align-middle">分未満</p>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :price, "価格" %>
    </div>
    <div class="col-sm-3">
      <%= f.number_field :price_gteq, class: "form-control", style: "width:60%" ,min:0 %>
      <p class="align-middle">万円〜</p>
    </div>
    <div class="col-sm-3">
      <%= f.number_field :price_lt, class: "form-control", style: "width:60%" ,min:0 %>
      <p class="align-middle">万円未満</p>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :building_coverage_ratio, "建ぺい率" %>
    </div>
    <div class="col-sm-3">
      <%= f.number_field :building_coverage_ratio_gteq, class: "form-control", style: "width:50%" ,min:0 %>
      <p class="align-middle">％〜</p>
    </div>
    <div class="col-sm-3">
      <%= f.number_field :building_coverage_ratio_lt, class: "form-control", style: "width:50%" ,min:0 %>
      <p class="align-middle">％未満</p>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :floor_area_ratio, "容積率" %>
    </div>
    <div class="col-sm-3">
      <%= f.number_field :floor_area_ratio_gteq, class: "form-control", style: "width:50%" ,min:0 %>
      <p class="align-middle">％〜</p>
    </div>
    <div class="col-sm-3">
      <%= f.number_field :floor_area_ratio_lt, class: "form-control", style: "width:50%" ,min:0 %>
      <p class="align-middle">％未満</p>
    </div>
  </div>
  <div class="form-group row h5">
    <div class="col-sm-3">
    </div>
    <div class="col-sm-2">
      <%= f.label :use_area, "用途地域" %>
    </div>
    <div class="col-sm-4">
      <%= f.search_field :use_area_cont, class: "form-control" %>
    </div>
  </div>
<br>
  <div class="row justify-content-center">
    <div class="col-sm-2">
      <%= f.submit "検索する", class: "btn btn-success text-light btn-lg btn-block" %>
    </div>
  </div>
<% end %>
</div>

<br>
<br>
  <table class="table table-bordered">
    <thead class="h5 table-secondary text-center">
      <tr>
        <th style="width: 8%">物件ID</th>
        <th style="width: 14%">物件画像</th>
        <th style="width: 64%">概要</th>
        <th style="width: 24%">申請</th>
      </tr>
    </thead>
    <tbody>
      <% @properties.each do |property| %>
      <tr class="h5 text-center">
        <td class="align-middle text-center"><%= property.id %></td>
        <td class="align-middle text-center">
          <% if property.image.attached? %>
            <%= image_tag property.image, size: "100x100" %>
          <% else %>
            <%= image_tag 'default-image', size: "100x100" %>
          <% end %>
        </td>
        <td class="align-middle text-center">
            <%= property.sell_category %>&emsp;
            <%= property.prefecture %>
            <%= property.municipality %>
            <%= property.city_block %>&emsp;
            <%= property.kind %>&emsp;<br>
            <%= property.line %>線&emsp;
            <%= property.station %>駅&emsp;
            徒歩<%= property.walking_minute %>分<br>
            <%= property.price %>万円&emsp;
            <% if property.kind = 0 %>
              <%= property.land_area %>㎡&emsp;
            <% else %>
              <%= property.land_area %>㎡&emsp;
              <%= property.building_area %>㎡&emsp;
            <% end %>
            <%= property.right %>&emsp;
            <%= property.use_area %><br>
            建ぺい率<%= property.building_coverage_ratio %>％&emsp;
            容積率<%= property.floor_area_ratio %>％
        </td>
        <td class="align-middle text-center">
          <% if @view_application.apply_status = 0 || @view_application.apply_status = 3 %>
          <%= link_to "閲覧申請する", view_applications_confirm_path, class: "btn btn-primary text-light btn-block"  %>
          <% elsif @view_application.apply_status = 1 %>
          <%= link_to "申請中", edit_view_application_path(@view_application), class: "btn btn-warning text-light btn-block"  %>
          <% elsif @view_application.apply_status = 2 %>
          <%= link_to "詳細を見る", property_path(@property), class: "btn btn-success text-light btn-block"  %>
          <% end %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
<%= paginate @properties %>

<br>
<br>
</div>